# Versionamento e gerenciamento de projeto

O uso de sistemas de versionamento e controle de código é fundamental no desenvolvimento de software. Alguns tipos principais são Git, Mercurial e SVN. Vamos falar sobre Git ([aqui está o link para um livro online em português sobre essa ferramenta, com bem mais detalhes](https://git-scm.com/book/pt-br/v2)).

Esse tipo de controle de repositório (o que seria o seu projeto) é utilizado por muitas ferramentas externas, como por exemplo o Cloud Build da Unity, como fonte para serviços de compilação e distribuição automática para teste. Saber utilizar um repositório é requisito básico para poder utilizar essas ferramentas de forma efetiva.

Para aprender os comandos básicos, é possível praticar neste [tutorial interativo](https://try.github.io/). Os principais comandos estão listados e explicados abaixo.

### Criando um repositório

#### Localmente

```
$ git init
```

Pronto, essa pasta do seu computador agora tem um repositório Git.

#### No Github

Para controlar seu repositório via itnernet, deve-se criá-lo em um serviço de hospedagem, como o Github ou BitBucket. Isso é feito a partir da interface do site, na `Home` do usuário. Tem um botão bem grande `New Repository`. Depois de feita essa etapa, você deve executar os comandos abaixo para fazer a ligação entre sua versão local e a online.

```
$ git remote add origin URL-REPO.git
$ git push -u origin master
```

### Listando modificações: `status` e `add`

```
$ git status
$ git add *
```

Com esses comandos, conseguimos ver o estado da nossa pasta de projeto, assim como depois adicionar arquivos à nossa `staging area`, ou seja, o conjunto de modificações que serão salvas.

### Salvando modificações: `commit` e `push`

```
$ git commit -m "minha mensagem de commit"
$ git push origin master
```

Quando estamos certos de que queremos salvar nossas modificações que já adicionamos à `staging area`, criamos um `commit`. É uma versão do projeto que incorpora essas modificações e associa uma mensagem e histórico a elas. Esse commit ainda existe localmente, só nessa máquina, até ser feito o comando `push`, quando estas alterações são mandadas para o servidor.

Onde está a palavra `master` acima, poderiam estar o nome de outras `branches`. Mas, o que é isso? Vamos ver mais adiante.

### Recuperando alterações: `pull`

Quando existem alterações no servidor e você quer baixar elas para sua máquina local, o comando a ser utilizado é `git pull`.

### Combinando `branches`: o comando `merge`

Uma boa prática para o desenvolvimento de novas features ou funcionalidade do jogo é criar `branches`, ou ramificações, do projeto, que permitem o desenvolvimento em paralelo de forma mais organizada. Os desenvolvedores criam uma `branch` no início do desenvolvimento de uma funcionalidade, vão fazendo commits nela, até chegar numa versão para ser integrada com o resto do projeto. Aí essa `branch` é combinada usando o comando `merge` com outra ramificação e possíveis conflitos são resolvidos.

```
// criação de uma nova branch e 'entrar' nela
$ git branch nova-ramificacao
$ git checkout nova-ramificacao

...

// muitos commits depois, o merge:
// 1. mudar para a branch de destino
// 2. rodar o merge
$ git checkout master
$ git merge iss53
```

## Usando o Git com a Unity

### Configurações no editor

Em `Edit > Project Settings > Editor`, mude a opção `Version control` para `Visible meta files`. Salve o projeto, feche e abra o editor para atualizar a pasta.

### Arquivos a ignorar

Em uma pasta de projeto que está sendo versionada é comum querer ignorar alguns arquivos que não são necessários para definir o projeto ou que serão gerados automaticamente pela máquina de cada usuário. Isso é definido em um arquivo de ignore. No caso do git, ele se chama `.gitignore`.

Abaixo, um exemplo de `.gitignore` para uso em um repositório com múltiplos projetos da Unity. Repare na inclusão de todos os arquivos `.meta` e na exclusão das pastas `Temp`, `Library` e `Obj`. Essas pastas e outros arquivos ignorados são gerados automaticamente pela ferramenta baseada no conteúdo das pastas  `Assets` e `ProjectSettings`.

```
**[Ll]ibrary/
**[Tt]emp/
**[Oo]bj/

# Autogenerated VS/MD solution and project files
**.csproj
**.unityproj
**.sln
**.apk
**.sln.DotSettings.user
**.suo
**.userprefs
**.pidb

# include meta files
!**.meta
```
